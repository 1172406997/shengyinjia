<!DOCTYPE html>
<!-- saved from url=(0214)http://superbank.olvip.vip/superbank/wx/creditcard!visa_application_stepThree.action?creditBankId=13&h5Link=https%253A%252F%252Finteracts.hq.vidata.com.cn%252Fh5%252Fcard-platform%252Findex.html%253Fsource%253D1075 -->
<html lang="en" style="font-size: 80.9333px;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">                                                              
	
    
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>信用卡申请</title>
    <link rel="stylesheet" href="./static/css/common.css">
    <link rel="stylesheet" href="./static/css/layer.css">
    <link rel="stylesheet" href="./static/css/swiper.css">
    <script src="./static/js/jquery-2.1.1.js"></script>
    <script src="./static/js/jweixin-1.2.0.js"></script>
    <script id="wxScript" type="text/javascript" src="./static/js/wxconfig.js" sharepage="index" orgid="231766" userid="360152" sharelogo="http://agent-attch.oss-cn-hangzhou.aliyuncs.com/abcd_1515090898870_69579.jpg?Expires=1517648961&amp;OSSAccessKeyId=Ck76WULSZApw3ZFv&amp;Signature=j6ZTgjIoNAX8Ml7LOPX18UNhht4%3D"></script>
<link rel="stylesheet" href="./static/css/layer(1).css" id="layuicss-skinlayercss"></head>
<body>       
<div>
	<div id="loaddingDiv" style="display:none">
        <div class="loading">
        </div>
        <div class="loadingImg"><img src="./static/image/loading.gif" alt=""></div>
    </div> 
    
    <div>
        <div class="visa_top">
            <img src="./static/image/check_cardbanner.png" alt="">
        </div>
        <!-- 进度条 -->
        <div class="visa2_progress_barWrap">
            <ul class="visa2_progress_bar">
                <li>
                    <div class="step1 active"><i class="active"></i></div>
                    <span class="active">填写申请人信息</span>
                </li>
                <li>
                    <div class="step2"><i></i></div>
                    <span>提交信用卡申请</span>
                </li>
                <li>
                    <div class="step3"><i></i></div>
                    <span>银行审核通知</span>
                </li>
            </ul>
        </div>
        <!-- 进度条end -->
        <div class="visa2_info">
            <div class="visa2_infoTitle">请选择申请人信息</div>
            <div>
                <div id="applicantList"><div class="visa2_oneTitle" style="display:none;"><span>马红鑫</span><div class="visa2_oneImg"><img src="./static/image/arrow_right.png" alt=""></div></div><div class="visa2_oneInfoComment"><div class="visa2_oneInfoWrap"><ul class="visa2_oneInfo"><li class="visa2_oneInfoLi1"><div><div>姓　名</div><span class="visa2_name">马红鑫</span></div></li><li class="visa2_oneInfoLi"><div>手机号</div><span class="visa2_tel">185****7956</span><span class="visa2_telHidden" style="display:none">18569947956</span></li><li class="visa2_oneInfoLi"><div>身份证</div><span class="visa2_Id">410721********4048</span><span class="visa2_IdHidden" style="display:none">410721199709154048</span></li></ul><div class="visa2_selectPic visa2_dis"><img src="./信用卡申请_files/designate@2x.png" alt=""></div><div class="visa2_oneFooter"><div class="visa2_check">选为申请人</div><div class="visa2_del" onclick="toToastDel(141777)"><i></i>删除</div></div></div><div class="visa2_oneInfoTab"><img src="./信用卡申请_files/arrow_down.png" alt=""></div></div></div>
                
                <div class="visa2_add" onclick="toFour()">
                    +添加申请人信息
                </div>
                
                <div class="visa2_footer">
                    <div class="visa2_agreementWrap">
                        <div class="visa2_agreement"><i></i>阅读并同意<a href="http://superbank.olvip.vip/superbank/wx/index!agreement.action">《平台服务协议》</a></div>
                    </div>
                    <div class="visa2_btn"><input disabled="" id="clickBtn" class="" type="button" value="下一步" onclick="toNextStep()"></div>
                </div>
            </div>
        </div>
        <div class="nav" id="nav" style="visibility: visible; display: block;">
	        <a href="http://superbank.olvip.vip/superbank/wx/index!index.action"><img src="./static/image/home_icon@2x.png" alt=""></a>
	        <a href="javascript:void(0);" onclick="javascript:history.go(-1);"><img src="./static/image/back_icon@2x.png" alt=""></a>
	    </div>
    </div>
    
    <!--确认弹窗-->
    <div class="visa2_Popup">
        <div class="visa2_Popup-dialog ">
            <div class="visa2_Popup-content">
                <div class="visa2_Popup-body">  
                    <div class="visa2_Poptext">
                        <span>确定申请人信息</span>
                        <i id="close"></i>
                    </div>  
                    <ul class="popup_addOneInfo">
                        <li>
                            <div>姓　名</div>
                            <span id="nextStepName"></span>
                        </li>
                        <li>
                            <div>手机号</div>
                            <span id="nextStepPhone"></span>
                            <span id="nextStepPhoneHidden" style="display:none"></span>
                        </li>
                        <li>
                            <div>身份证</div>
                            <span id="nextStepNum"></span>
                            <span id="nextStepNumHidden" style="display:none"></span>
                        </li>
                    </ul> 
                </div>
                <div class="visa2_popBtn">
                    <a class="visa2_cancel" href="http://superbank.olvip.vip/superbank/wx/creditcard!applyTemplate.action">信用卡填写模板</a>
                    <a class="visa2_sure" href="JavaScript:void(0);">确定申请</a>
                </div>
            </div>
        </div>
        <div class="visa2_masked"></div>
    </div>  
    
    <div class="weui-mask "></div>
	<div class="weui-dialog ">
	    <div class="weui-dialog__hd">
	        <div class="weui-dialog__title">温馨提示</div>
	    </div>
	    <div class="weui-dialog_bd" style="text-align:center;">您确认删除此申请人吗？</div>
	    <div class="weui-dialog_footer">
	        <a class="weui-dialog_cancel" href="javascript:void(0);">取消</a>
	        <a class="weui-dialog_sure" href="javascript:void(0);">确认</a>
	    </div>
	</div>
</div>
<script src="./static/js/layer.js"></script>
<script src="./static/js/Inertia.js"></script>
<script src="./static/js/swiper.js"></script>
<script id="commonScript" src="./static/js/adaptive.js" source=""></script>
<script>
	//滑动的小球
	new Inertia(document.getElementById('nav'));
	//滑动的小球end
	//弹出框
	$(".visa2_del").click(function(){
		$(".weui-mask").addClass("weui-mask--visible");
	    $(".weui-dialog").addClass("weui-dialog--visible");
	})
	$(".weui-dialog_cancel").click(function(){
	    $(".weui-mask").removeClass("weui-mask--visible");
	    $(".weui-dialog").removeClass("weui-dialog--visible");
	})
	
	function toToastDel(_id){
		$(".weui-mask").addClass("weui-mask--visible");
	    $(".weui-dialog").addClass("weui-dialog--visible");
	    
	    $(".weui-dialog_sure").click(function(){
	    	delApplicant(_id);
        })
	}
	
	// 确认弹窗
	function popup5() {
	    $(".visa2_Popup").removeClass("visa2_Popup_in").addClass("visa2_Popup_fade");
	    $(".visa2_Popup-backdrop").removeClass("visa2_Popup_in2").removeClass("visa2_Popup_fade").addClass("fa_Popup_fade");
	}
	  $("#close").click(function( ){//这个是关闭弹出框
	        $(".visa2_Popup-dialog").animate({bottom: -1000});
	        setTimeout("popup5()", 200);
	    });
	function toToastNext() {
	    $(".visa2_Popup-backdrop").toggleClass("visa2_Popup_in2");
	    $(".visa2_Popup").toggleClass("visa2_Popup_in");
	    $(".visa2_Popup-dialog").animate({bottom:0});
	    
	    $(".visa2_sure").click(function(){
	    	submitCreditcard();
        })
	};
	$(".visa2_masked").click(function(){
	    $(".visa2_Popup-dialog").animate({bottom: -1000});
	    setTimeout("popup5()", 200);
	})
	
	var redirectUrl = '';
	var creditBankId = '';
	
	$(function(){
		var jsonObject = {"code":"success","message":"调用成功","data":[{"id":141777,"userId":360152,"realName":"马红鑫","phone":"18569947956","identityNumber":"410721199709154048","isDel":"0","createDate":1517535882000}],"totalCount":null};
		
		redirectUrl = 'https://interacts.hq.vidata.com.cn/h5/card-platform/index.html?source=1075';
		creditBankId = '13';

		if (jsonObject.data.length > 0) {
			$(".visa2_infoTitle").html("请选择申请人信息")
			
			var htmlStr = '';
			for (var i = 0; i < jsonObject.data.length; i++ ) {
				
				var phone = '';
				if (jsonObject.data[i].phone.length >= 8) {
					phone = jsonObject.data[i].phone.substring(0,3)+'****' + jsonObject.data[i].phone.substring(7,jsonObject.data[i].phone.length);
				}else {
					phone = jsonObject.data[i].phone;
				}
				
				var identityNumber = '';
				if (jsonObject.data[i].identityNumber.length >= 15) {
					identityNumber = jsonObject.data[i].identityNumber.substring(0,6)+'********' + jsonObject.data[i].identityNumber.substring(14,jsonObject.data[i].identityNumber.length);
				}else {
					identityNumber = jsonObject.data[i].identityNumber;
				}
				
				htmlStr += '<div class="visa2_oneTitle" style="display:none;">';
				htmlStr += '<span>'+jsonObject.data[i].realName+'</span>';
				htmlStr += '<div class="visa2_oneImg"><img src="static/image/arrow_right.png" alt=""></div>';
				htmlStr += '</div>';
				htmlStr += '<div class="visa2_oneInfoComment">';
				htmlStr += '<div class="visa2_oneInfoWrap" >';
				htmlStr += '<ul class="visa2_oneInfo">';
				htmlStr += '<li class="visa2_oneInfoLi1">';
				htmlStr += '<div>';
				htmlStr += '<div>姓&#12288;名</div>';
				htmlStr += '<span class="visa2_name">'+jsonObject.data[i].realName+'</span>';
				htmlStr += '</div>';
/* 				htmlStr += '<span class="visa2_oneInfoTab"><img src="/superbank/resources/img/arrow_down.png" alt=""></span>'; */
				htmlStr += '</li>';
				htmlStr += '<li class="visa2_oneInfoLi">';
				htmlStr += '<div>手机号</div>';
				htmlStr += '<span class="visa2_tel">'+phone+'</span>';
				htmlStr += '<span class="visa2_telHidden" style="display:none">'+jsonObject.data[i].phone+'</span>';
				htmlStr += '</li>';
				htmlStr += '<li class="visa2_oneInfoLi">';
				htmlStr += '<div>身份证</div>';
				htmlStr += '<span class="visa2_Id">'+identityNumber+'</span>';
				htmlStr += '<span class="visa2_IdHidden" style="display:none">'+jsonObject.data[i].identityNumber+'</span>';
				htmlStr += '</li>';
				htmlStr += '</ul>';
				htmlStr += '<div class="visa2_selectPic visa2_dis">';
				htmlStr += '<img src="static/image/designate@2x.png" alt="">';
				htmlStr += '</div>';
				htmlStr += '<div class="visa2_oneFooter">';
				htmlStr += '<div class="visa2_check">';
/* 				htmlStr += '<i></i>'; */
				htmlStr += '选为申请人';
				htmlStr += '</div>';
				htmlStr += '<div class="visa2_del" onclick="toToastDel('+jsonObject.data[i].id+')"><i></i>删除</div>';
				htmlStr += '</div>';
				htmlStr += '</div>';
				htmlStr += '<div class="visa2_oneInfoTab">';
				htmlStr += '<img src="static/image/arrow_down.png" alt="">';
				htmlStr += '</div>';
			}
			
			$("#applicantList").html(htmlStr);
			
			//点击展开隐藏
			 $(".visa2_oneImg").click(function(){
		        $(this).parents(".visa2_oneTitle").next(".visa2_oneInfoComment").show();
		        $(this).parent(".visa2_oneTitle").hide();
		        $(".visa2_agreementWrap").show();
		    });
		    $(".visa2_oneInfoTab").click(function(){
		        $(this).parents(".visa2_oneInfoComment").prev(".visa2_oneTitle").show();
		        $(this).parents(".visa2_oneInfoComment").hide();
		        $(".visa2_agreementWrap").hide();
		    });
			//选中没选中切换
			$(".visa2_oneInfoWrap").click(function(){
		        if($(this).find(".visa2_check").hasClass("active")){
		         /*    $(this).find(".visa2_check").removeClass("active");
		            $(this).find(".visa2_selectPic").addClass("visa2_dis"); */
		            
		/*             $("#clickBtn").removeClass("active");
			    	$("#clickBtn").attr("disabled",true); */
		        }else{
		        	 $(".visa2_oneInfoWrap").each(function(){
		                 $(this).find(".visa2_check").removeClass("active");
		                 $(this).find(".visa2_selectPic").addClass("visa2_dis")
		             });

		            $(this).find(".visa2_check").addClass("active");
		            $(this).find(".visa2_selectPic").removeClass("visa2_dis");
		            if ($(".visa2_agreement").find("i").hasClass("active") ) {
						$("#clickBtn").addClass("active");
				    	$("#clickBtn").attr("disabled",false);
					}
		        }
		      
		    })
		/* 	$(".visa2_check").click(function(){
				if ($(this).find("i").hasClass("active")) {
					$(this).find("i").removeClass("active");
					
					$("#clickBtn").removeClass("active");
			    	$("#clickBtn").attr("disabled",true);
				}else {
					$(".visa2_check>i").each(function(){
						$(this).removeClass("active");
					});
					
					$(this).find("i").addClass("active");
					
					if ($(".visa2_agreement").find("i").hasClass("active") ) {
						$("#clickBtn").addClass("active");
				    	$("#clickBtn").attr("disabled",false);
					}
				}
			    
			}); */
		}else {
			$(".visa2_infoTitle").html("请添加申请人信息");
		}
	})
	
	$(".visa2_agreement").click(function() {
		if ($(this).find("i").hasClass("active")) {
			$(this).find("i").removeClass("active");
			
			$("#clickBtn").removeClass("active");
	    	$("#clickBtn").attr("disabled",true);
		}else {
			$(this).find("i").addClass("active");
			
			var hasAc = false;
			$(".visa2_check").each(function(){
				if ($(this).hasClass("active")) {
					hasAc = true;
				}
			});
			
			if (hasAc) {
				$("#clickBtn").addClass("active");
		    	$("#clickBtn").attr("disabled",false);
			}
		}
			
	})
	
	function toFour() {
//		location.href = 'creditcard!visa_application_stepFour.action?creditBankId=13&h5Link='+encodeURIComponent(encodeURIComponent('https://interacts.hq.vidata.com.cn/h5/card-platform/index.html?source=1075'));
		location.href = 'card_apply_for.html';
	}
	
	function delApplicant(_id){
		$("#loaddingDiv").attr("style","display:block");
    	$.ajax({
			   url:'creditcard!deleteCreditcardApplicant.action?id='+_id,
			   dataType:'json',
			   success:function(data){
				   $("#loaddingDiv").attr("style","display:none");
				   if(data.code == 'success'){
					   window.location.reload();
				   }
			   },
			   error:function(error){ 
				   $("#loaddingDiv").attr("style","display:none");
				   layer.msg(error, {
	                   time: 1000
	               });
			   } 
			});
    	
    }
	
	function toNextStep() {
		$(".visa2_check").each(function(){
            if($(this).hasClass("active")){
            	var name=$(this).parents(".visa2_oneInfoWrap").find(".visa2_name").text();
            	var tel=$(this).parents(".visa2_oneInfoWrap").find(".visa2_tel").text();
            	var id=$(this).parents(".visa2_oneInfoWrap").find(".visa2_Id").text();
            	
            	var telHidden=$(this).parents(".visa2_oneInfoWrap").find(".visa2_telHidden").text();
            	var idHidden=$(this).parents(".visa2_oneInfoWrap").find(".visa2_IdHidden").text();
            	
                $("#nextStepName").html(name);
                $("#nextStepPhone").html(tel);
                $("#nextStepNum").html(id);
                
                $("#nextStepPhoneHidden").html(telHidden);
                $("#nextStepNumHidden").html(idHidden);
            }
        });
		
		toToastNext();
	}
	
	function submitCreditcard() {
		$("#loaddingDiv").attr("style","display:block");
		$.ajax({
			   url:'creditcard!saveCreditcardApplicant.action',
			   dataType:'json',
			   data: {
				   "realName": encodeURIComponent($("#nextStepName").html()),
				   "phone": $("#nextStepPhoneHidden").html(),
				   "identityNumber": $("#nextStepNumHidden").html(),
				   "creditBankId": creditBankId,
				   "isNeedAdd": '0',
				   },
			   success:function(data){
				   $("#loaddingDiv").attr("style","display:none");
				   if(data.code == 'success'){
					   window.location.href = redirectUrl;
				   }
			   },
			   error:function(error){
				   $("#loaddingDiv").attr("style","display:none");
				   layer.msg(error, {
	                   time: 1000
	               });
			   } 
			});
	}
	
</script>

</body></html>